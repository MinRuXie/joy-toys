import{z as x,A as w,r as u,o as q,a as m,c as p,b as a,F as U,h as I,m as ce,G as ne,l as H,t as j,u as P,H as ue,I as ie,J as me,k as F,n as z,j as L,q as N,C as T}from"./index.ba7e6c29.js";var de="/joy-toys/assets/bottle_01.f0c22f61.png",ge="/joy-toys/assets/bottle_02.b16d99cc.png",_e="/joy-toys/assets/bottle_03.f82feafb.png",ve="/joy-toys/assets/bottle_04.387b6590.png",pe="/joy-toys/assets/bottle_05.519ce283.png",ye="/joy-toys/assets/bottle_06.46b872b6.png",be="/joy-toys/assets/candy_01.8c403edd.png",he="/joy-toys/assets/candy_02.fb8bba87.png",fe="/joy-toys/assets/candy_03.0a5d9b45.png",je="/joy-toys/assets/muti_object_01.880baf8c.png",we="/joy-toys/assets/muti_object_02.1b4f3ea2.png",Pe="/joy-toys/assets/muti_object_03.86ec11d6.png",ke="/joy-toys/assets/bear.47659926.png",Le="/joy-toys/assets/butterfly.36d2d231.png",$e="/joy-toys/assets/double-heart.9290c62b.png",De="/joy-toys/assets/flower.e3e241e6.png";const Ce={class:"game-page loading-page"},Se=a("h2",{class:"page-title"},"Loading...",-1),Ge=[Se],Me={__name:"RunwayGameLoading",props:x({charaterList:Array},{gameProgress:{},gameProgressModifiers:{}}),emits:["update:gameProgress"],setup(d){const g=w(d,"gameProgress"),y=d,r=u(!0);async function o(){function i(l){let t=new Image;t.src=l}for(let l=0;l<y.charaterList.length;l++)i(y.charaterList.imgUrl)}return q(()=>{o().then(function(){function i(){switch(console.log("Loading..."),document.readyState){case"interactive":case"complete":r.value=!1,r.value||setTimeout(()=>{g.value="choose"},1500),clearInterval(l),console.log("Ready!");break}}let l=setInterval(i,500)})}),(i,l)=>(m(),p("div",Ce,Ge))}},Ne={class:"game-page select-page"},Te=a("h2",{class:"page-title"},"Select Player",-1),Ue={class:"player-card-wrap"},xe=["for"],Re=["id","value"],Xe={class:"image-wrap"},Ee=["src","alt"],Ie={class:"text-wrap"},He={class:"card-title"},Ye={__name:"RunwayGameChoose",props:x({charaterList:Array},{gameProgress:{},gameProgressModifiers:{},curCharaterData:{},curCharaterDataModifiers:{}}),emits:["update:gameProgress","update:curCharaterData"],setup(d){const g=w(d,"gameProgress"),y=w(d,"curCharaterData"),r=d,o=u(1);function i(){console.log(r.charaterList),console.log("\u9078\u64C7\u89D2\u8272",o.value);let l=r.charaterList.filter(t=>t.imgId==o.value);y.value=l[0],g.value="playing"}return(l,t)=>(m(),p("div",Ne,[Te,a("div",Ue,[(m(!0),p(U,null,I(r.charaterList,(c,v)=>(m(),p("label",{key:v,class:"radio-label",for:`player-${v}`},[ce(a("input",{type:"radio",class:"btn-check",name:"options",id:`player-${v}`,autocomplete:"off",value:c.imgId,"onUpdate:modelValue":t[0]||(t[0]=h=>o.value=h)},null,8,Re),[[ne,o.value]]),a("div",{class:H(["card player-card",{active:c.imgId===o.value}])},[a("div",Xe,[a("img",{src:c.imgUrl,alt:c.imgName},null,8,Ee)]),a("div",Ie,[a("span",He,j(c.playerName),1)])],2)],8,xe))),128))]),a("div",{class:"btns-wrap"},[a("button",{type:"button",onClick:i,class:"btn btn-primary"},"Start Game")])]))}},We={class:"game-page play-page"},Oe={class:"header"},Ae={class:"header-item"},Be=a("span",{class:"item-title"},"Lives:",-1),Ve={class:"item-content"},Fe={class:"header-item"},ze=a("span",{class:"item-title"},"Scores:",-1),qe={class:"item-content"},Je={class:"header-item"},Ke=a("span",{class:"item-title"},"Time:",-1),Qe={class:"item-content"},Ze=["data-id"],ea=["src","alt"],aa=["src"],ta={__name:"RunwayGamePlaying",props:x({curCharaterData:Object,objectsDataList:Array},{gameProgress:{},gameProgressModifiers:{},lastGameScores:{},lastGameScoresModifiers:{}}),emits:["update:gameProgress","update:lastGameScores"],setup(d){const g=d,y=w(d,"gameProgress"),r=w(d,"lastGameScores"),o=P(()=>!(s.value.lives>0)),i=u(null),l=u(0),t=u(0),c=u(4),v=u([]),h=P(()=>v.value.length);let R=[];const J=function(e){e&&R.push({id:e.getAttribute("data-id"),el:e})};ue(()=>{R=[]}),ie(()=>{});function K(){let e=0,_=c.value-1,n=Math.round(Math.random()*(_-e))+e,f=h.value>0&&h.value%10==0?"good":"bad",G=g.objectsDataList.filter(k=>k.objectType===f),M=0,oe=G.length-1,le=Math.round(Math.random()*(oe-M))+M,E=G[le];v.value.push({id:h.value>0?v.value[h.value-1].id+1:0,type:f,score:10,isProcessed:!1,imgUrl:E.imgUrl,imgName:E.imgName,objectName:E.objectName,show:!0,hit:!1,track:n,curX:(l.value-20)/c.value*n+s.value.curW/2,curY:0,curW:0,curH:0}),F(()=>{R.forEach(k=>{k.id==v.value[h.value-1].id&&(v.value[h.value-1].curW=k.el.clientWidth,v.value[h.value-1].curH=k.el.clientHeight)})}),Q(v.value[h.value-1])}const Y=u(5),W=u(30);function Q(e){Y.value+=.01;let _=e.curY,n=setTimeout(f,W.value);function f(){if(console.log("check"),o.value){clearTimeout(n);return}if(n=setTimeout(f,W.value),_>t.value)e.isProcessed||(e.isProcessed=!0,e.type=="bad"&&!e.hit&&(s.value.scores+=e.score)),e.show=!1;else if(_+=Y.value,e.curY=Math.round(_,0),e.curY>t.value-2*e.curH){let G=e.curX-s.value.curW,M=e.curX+e.curW;if(e.curY+e.curH>s.value.curY&&s.value.curX>=G&&s.value.curX<=M&&!e.hit){switch(e.hit=!0,e.isProcessed=!0,e.type){case"bad":s.value.lives==1&&(s.value.deathReason={id:e.id,name:e.objectName,imgUrl:e.imgUrl,imgName:e.imgName}),s.value.attacked=!0,s.value.lives--;break;case"good":s.value.restore=!0,s.value.lives++;break}setTimeout(function(){s.value.attacked=!1,s.value.restore=!1},600)}}}}const Z=u(1500);function O(){o.value||(console.log("addObject"),K(),setTimeout(O,Z.value))}const b=u(null),s=u({id:g.curCharaterData.id,name:g.curCharaterData.name,pace:10,lives:3,scores:0,playingTime:0,attacked:!1,restore:!1,deathReason:null,curW:0,curH:0,curX:0,curY:0}),ee=P(()=>10),ae=P(()=>l.value-s.value.curW-15);function $(e,_){switch(e){case"left":s.value.curX>=ee.value&&(s.value.curX-=_);break;case"right":s.value.curX<=ae.value&&(s.value.curX+=_);break}}const D=u(null),te=u(50),se=setInterval(function(){if(D.value!=null){if(o.value){clearInterval(se);return}switch(console.log("playerKeyboardMove"),D.value){case"ArrowLeft":$("left",s.value.pace);break;case"ArrowRight":$("right",s.value.pace);break}}},te.value),X=u(null),C=u(!1);function A(e){o.value||(console.log("moveStart"),e.type=="touchstart"&&(e=e.touches[0]),C.value=!0,X.value=e.clientX)}function B(e){if(o.value||!C.value)return;console.log("moveing"),e.type=="touchmove"&&(e=e.touches[0]);let _=e.clientX,n=_-X.value;X.value=_;let f=Math.abs(n)>10?10:Math.abs(n);n<0?$("left",f):$("right",f)}function S(e){o.value||!C.value||(console.log("moveEnd"),C.value=!1)}me(o,async(e,_)=>{e&&setTimeout(()=>{r.value=s.value,y.value="result"},500)});const re=new Date;function V(){if(o.value)return;console.log("addTime");let e=new Date;s.value.playingTime=((e-re)/1e3).toFixed(2),setTimeout(V,10)}return q(()=>{document.addEventListener("keydown",e=>{D.value=e.key}),document.addEventListener("keyup",e=>{D.value=null}),F(()=>{l.value=i.value.clientWidth,t.value=i.value.clientHeight,s.value.curW=b.value.clientWidth,s.value.curH=b.value.clientHeight,s.value.curX=l.value/2+15,s.value.curY=t.value-s.value.curH-10,b.value.addEventListener("mousedown",A),b.value.addEventListener("touchstart",A),b.value.addEventListener("mousemove",B),b.value.addEventListener("touchmove",B),b.value.addEventListener("mouseup",S),b.value.addEventListener("mouseleave",S),b.value.addEventListener("touchend",S),b.value.addEventListener("touchcancel",S),O(),V()})}),(e,_)=>(m(),p("div",We,[a("div",Oe,[a("div",Ae,[Be,a("span",Ve,[(m(!0),p(U,null,I(s.value.lives,n=>(m(),p("span",{class:"live",key:n}))),128))])]),a("div",Fe,[ze,a("span",qe,j(s.value.scores),1)]),a("div",Je,[Ke,a("span",Qe,j(s.value.playingTime)+"s",1)])]),a("div",{ref_key:"refTrack",ref:i,class:"track"},[(m(!0),p(U,null,I(v.value,(n,f)=>(m(),p(U,{key:n.id},[n.show?(m(),p("div",{key:0,ref_for:!0,ref:J,"data-id":n.id,class:H(["object",{hit:n.hit,hide:!n.show}]),style:z({top:`${n.curY}px`,left:`${n.curX}px`})},[a("img",{src:n.imgUrl,alt:n.imgName},null,8,ea)],14,Ze)):L("",!0)],64))),128)),a("div",{ref_key:"refPlayer",ref:b,class:H(["player",{attacked:s.value.attacked,restore:s.value.restore}]),style:z({top:`${s.value.curY}px`,left:`${s.value.curX}px`})},[a("img",{src:g.curCharaterData.imgUrl,alt:"props.curCharaterData.imgName"},null,8,aa)],6)],512)]))}},sa={class:"game-page result-page"},ra=a("h2",{class:"page-title"},"Game Over",-1),oa={class:"card result-card"},la={class:"image-wrap"},ca=["src","alt"],na={class:"text-wrap"},ua={class:"card-title"},ia={class:"list-group list-group-flush"},ma={class:"list-group-item"},da={class:"text-primary"},ga={class:"list-group-item"},_a={class:"text-primary"},va={class:"list-group-item"},pa={class:"obj-image"},ya={class:"image-wrap"},ba=["src","alt"],ha={class:"obj-title"},fa={__name:"RunwayGameResult",props:x({curCharaterData:Object},{gameProgress:{},gameProgressModifiers:{},lastGameScores:{},lastGameScoresModifiers:{}}),emits:["update:gameProgress","update:lastGameScores"],setup(d){const g=d,y=w(d,"gameProgress"),r=w(d,"lastGameScores");function o(){y.value="playing"}function i(){y.value="choose"}return(l,t)=>(m(),p("div",sa,[ra,a("div",oa,[a("div",la,[a("img",{src:g.curCharaterData.imgUrl,alt:g.curCharaterData.imgName},null,8,ca)]),a("div",na,[a("span",ua,j(g.curCharaterData.playerName),1),a("ul",ia,[a("li",ma,[N("Your score is "),a("span",da,j(r.value.scores),1)]),a("li",ga,[N("Survive for "),a("span",_a,j(r.value.playingTime),1),N(" seconds")]),a("li",va,[N(" Reasons for losing: "),a("div",pa,[a("div",ya,[a("img",{src:r.value.deathReason.imgUrl,alt:r.value.deathReason.imgName},null,8,ba)]),a("span",ha,j(r.value.deathReason.name),1)])])])])]),a("div",{class:"btns-wrap"},[a("button",{type:"button",onClick:o,class:"btn btn-primary"},"Play Again"),a("button",{type:"button",onClick:i,class:"btn btn-secondary"},"Reselect Player")])]))}},ja=[{id:1,name:"double-heart",player_name:"Double Heart"},{id:2,name:"flower",player_name:"Flower"},{id:3,name:"bear",player_name:"Bear"},{id:4,name:"butterfly",player_name:"Butterfly"}];var wa={charater:ja};const Pa=[{name:"candy_01",object_name:"Candy (Pink)",object_type:"good"},{name:"candy_02",object_name:"Candy (Yellow)",object_type:"good"},{name:"candy_03",object_name:"Candy (Blue)",object_type:"good"},{name:"bottle_01",object_name:"Love Poison",object_type:"bad"},{name:"bottle_02",object_name:"Love Letter Poison",object_type:"bad"},{name:"bottle_03",object_name:"Depression Poison",object_type:"bad"},{name:"bottle_04",object_name:"Depressive Poison",object_type:"bad"},{name:"bottle_05",object_name:"Heart Poison",object_type:"bad"},{name:"bottle_06",object_name:"Heartbreak Poison",object_type:"bad"},{name:"muti_object_01",object_name:"Compound Poison",object_type:"bad"},{name:"muti_object_02",object_name:"Compound Poison",object_type:"bad"},{name:"muti_object_03",object_name:"Compound Poison",object_type:"bad"}];var ka={objects:Pa};const La={class:"runway-game"},$a={class:"runway-game-inner"},Da={class:"page-outer"},Sa={__name:"RunwayGame",setup(d){const g=P(()=>{const l=[];return wa.charater.forEach(t=>{l.push({imgId:t.id,imgName:t.name,imgUrl:new URL({"/src/assets/images/runway-game/player/bear.png":ke,"/src/assets/images/runway-game/player/butterfly.png":Le,"/src/assets/images/runway-game/player/double-heart.png":$e,"/src/assets/images/runway-game/player/flower.png":De}[`/src/assets/images/runway-game/player/${t.name}.png`],self.location),playerName:t.player_name})}),l}),y=P(()=>{const l=[];return ka.objects.forEach(t=>{l.push({imgId:t.id,imgName:t.name,imgUrl:new URL({"/src/assets/images/runway-game/object/bottle_01.png":de,"/src/assets/images/runway-game/object/bottle_02.png":ge,"/src/assets/images/runway-game/object/bottle_03.png":_e,"/src/assets/images/runway-game/object/bottle_04.png":ve,"/src/assets/images/runway-game/object/bottle_05.png":pe,"/src/assets/images/runway-game/object/bottle_06.png":ye,"/src/assets/images/runway-game/object/candy_01.png":be,"/src/assets/images/runway-game/object/candy_02.png":he,"/src/assets/images/runway-game/object/candy_03.png":fe,"/src/assets/images/runway-game/object/muti_object_01.png":je,"/src/assets/images/runway-game/object/muti_object_02.png":we,"/src/assets/images/runway-game/object/muti_object_03.png":Pe}[`/src/assets/images/runway-game/object/${t.name}.png`],self.location),objectName:t.object_name,objectType:t.object_type})}),l}),r=u("loading"),o=u(null),i=u(null);return(l,t)=>(m(),p("div",La,[a("div",$a,[a("div",Da,[r.value=="loading"?(m(),T(Me,{key:0,gameProgress:r.value,"onUpdate:gameProgress":t[0]||(t[0]=c=>r.value=c),charaterList:g.value},null,8,["gameProgress","charaterList"])):L("",!0),r.value=="choose"?(m(),T(Ye,{key:1,gameProgress:r.value,"onUpdate:gameProgress":t[1]||(t[1]=c=>r.value=c),charaterList:g.value,curCharaterData:o.value,"onUpdate:curCharaterData":t[2]||(t[2]=c=>o.value=c)},null,8,["gameProgress","charaterList","curCharaterData"])):L("",!0),r.value=="playing"?(m(),T(ta,{key:2,gameProgress:r.value,"onUpdate:gameProgress":t[3]||(t[3]=c=>r.value=c),lastGameScores:i.value,"onUpdate:lastGameScores":t[4]||(t[4]=c=>i.value=c),curCharaterData:o.value,objectsDataList:y.value},null,8,["gameProgress","lastGameScores","curCharaterData","objectsDataList"])):L("",!0),r.value=="result"?(m(),T(fa,{key:3,lastGameScores:i.value,"onUpdate:lastGameScores":t[5]||(t[5]=c=>i.value=c),gameProgress:r.value,"onUpdate:gameProgress":t[6]||(t[6]=c=>r.value=c),curCharaterData:o.value},null,8,["lastGameScores","gameProgress","curCharaterData"])):L("",!0)])])]))}};export{Sa as default};
