import{x as Q,y as _,f as n,e as j,o as m,c as f,a as s,F as Y,m as q,i as N,D as O,s as M,E as le,G as ue,H as oe,g as z,t as i,k as C,p as W,n as Z,l as w,A as x,I as ne}from"./index.80a9d5c3.js";var ce="data:image/png;base64,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";const ie={class:"game-page"},ge=s("h2",null,"Loading...",-1),de=[ge],ve={__name:"RunwayGameLoading",props:Q({charaterList:Array},{gameProgress:{},gameProgressModifiers:{}}),emits:["update:gameProgress"],setup(g){const d=_(g,"gameProgress"),u=g,v=n(!0);async function l(){function c(t){let r=new Image;r.src=t}for(let t=0;t<u.charaterList.length;t++)c(u.charaterList.imgUrl)}return j(()=>{l().then(function(){function c(){switch(console.log("Loading..."),document.readyState){case"interactive":case"complete":v.value=!1,v.value||(d.value="choose"),clearInterval(t),console.log("Ready!");break}}let t=setInterval(c,500)})}),(c,t)=>(m(),f("div",ie,de))}},me={class:"game-page"},Ae=s("h2",null,"\u9078\u64C7\u89D2\u8272",-1),he=["src"],fe={class:"form-check"},pe=s("label",{class:"form-check-label",for:"flexRadioDefault1"}," \u89D2\u82721 (kana) ",-1),De={class:"form-check"},ye=s("label",{class:"form-check-label",for:"flexRadioDefault2"}," \u89D2\u82722 (aimer) ",-1),Pe={__name:"RunwayGameChoose",props:Q({charaterList:Array},{gameProgress:{},gameProgressModifiers:{},curCharaterData:{},curCharaterDataModifiers:{}}),emits:["update:gameProgress","update:curCharaterData"],setup(g){const d=_(g,"gameProgress"),u=_(g,"curCharaterData"),v=g,l=n(1);function c(){console.log(v.charaterList),console.log("\u9078\u64C7\u89D2\u8272",l.value);let t=v.charaterList.filter(r=>r.imgId==l.value);u.value=t[0],d.value="playing"}return(t,r)=>(m(),f("div",me,[Ae,s("ul",null,[(m(!0),f(Y,null,q(v.charaterList,D=>(m(),f("li",null,[s("img",{src:D.imgUrl,alt:"c.name"},null,8,he)]))),256))]),s("div",fe,[N(s("input",{class:"form-check-input",type:"radio",name:"flexRadioDefault",id:"flexRadioDefault1",value:"1","onUpdate:modelValue":r[0]||(r[0]=D=>l.value=D)},null,512),[[O,l.value]]),pe]),s("div",De,[N(s("input",{class:"form-check-input",type:"radio",name:"flexRadioDefault",id:"flexRadioDefault2",value:"2","onUpdate:modelValue":r[1]||(r[1]=D=>l.value=D)},null,512),[[O,l.value]]),ye]),s("button",{type:"button",onClick:c},"\u78BA\u5B9A")]))}},_e={class:"game-page"},ke={class:"fix-left"},Ce={class:"fix-right"},Me=s("br",null,null,-1),we={class:"header"},Ee=s("br",null,null,-1),Be=s("br",null,null,-1),Ue=["data-id"],Ge={class:"debug-text"},xe=s("br",null,null,-1),He=s("br",null,null,-1),Le=["src"],Ye={__name:"RunwayGamePlaying",props:Q({curCharaterData:Object},{gameProgress:{},gameProgressModifiers:{},lastGameScores:{},lastGameScoresModifiers:{}}),emits:["update:gameProgress","update:lastGameScores"],setup(g){const d=g,u=_(g,"gameProgress"),v=_(g,"lastGameScores"),l=M(()=>!(a.value.lives>0)),c=n(null),t=n(0),r=n(0),D=n(4),p=n([]),y=M(()=>p.value.length);let H=[];const V=function(e){e&&H.push({id:e.getAttribute("data-id"),el:e})};le(()=>{H=[]}),ue(()=>{});function K(){let e=0,A=D.value-1,o=Math.round(Math.random()*(A-e))+e,P=y.value>0&&y.value%10==0?"good":"bad";p.value.push({id:y.value>0?p.value[y.value-1].id+1:0,type:P,score:10,isProcessed:!1,show:!0,hit:!1,track:o,curX:(t.value-20)/D.value*o+a.value.curW/2,curY:0,curW:0,curH:0}),z(()=>{H.forEach(k=>{k.id==p.value[y.value-1].id&&(p.value[y.value-1].curW=k.el.clientWidth,p.value[y.value-1].curH=k.el.clientHeight)})}),F(p.value[y.value-1])}const I=n(5),R=n(30);function F(e){I.value+=.01;let A=e.curY,o=setTimeout(P,R.value);function P(){if(console.log("check"),l.value){clearTimeout(o);return}if(o=setTimeout(P,R.value),A>r.value)e.isProcessed||(e.isProcessed=!0,e.type=="bad"&&!e.hit&&(a.value.scores+=e.score)),e.show=!1;else if(A+=I.value,e.curY=Math.round(A,0),e.curY>r.value-2*e.curH){let k=e.curX-a.value.curW,re=e.curX+e.curW;if(e.curY+e.curH>a.value.curY&&a.value.curX>=k&&a.value.curX<=re&&!e.hit){switch(e.hit=!0,e.isProcessed=!0,e.type){case"bad":a.value.lives==1&&(a.value.deathReason=e.id),a.value.attacked=!0,a.value.lives--;break;case"good":a.value.restore=!0,a.value.lives++;break}setTimeout(function(){a.value.attacked=!1,a.value.restore=!1},600)}}}}const $=n(1500);function b(){l.value||(console.log("addObject"),K(),setTimeout(b,$.value))}const h=n(null),a=n({id:d.curCharaterData.id,name:d.curCharaterData.name,pace:10,lives:3,scores:0,playingTime:0,attacked:!1,restore:!1,deathReason:null,curW:0,curH:0,curX:0,curY:0}),J=M(()=>10),ee=M(()=>t.value-a.value.curW-15);function E(e,A){switch(e){case"left":a.value.curX>=J.value&&(a.value.curX-=A);break;case"right":a.value.curX<=ee.value&&(a.value.curX+=A);break}}const B=n(null),ae=n(50),te=setInterval(function(){if(B.value!=null){if(l.value){clearInterval(te);return}switch(console.log("playerKeyboardMove"),B.value){case"ArrowLeft":E("left",a.value.pace);break;case"ArrowRight":E("right",a.value.pace);break}}},ae.value),L=n(null),U=n(!1);function S(e){l.value||(console.log("moveStart"),e.type=="touchstart"&&(e=e.touches[0]),U.value=!0,L.value=e.clientX)}function T(e){if(l.value||!U.value)return;console.log("moveing"),e.type=="touchmove"&&(e=e.touches[0]);let A=e.clientX,o=A-L.value;L.value=A;let P=Math.abs(o)>10?10:Math.abs(o);o<0?E("left",P):E("right",P)}function G(e){l.value||!U.value||(console.log("moveEnd"),U.value=!1)}oe(l,async(e,A)=>{e&&setTimeout(()=>{v.value=a.value,u.value="result"},500)});const se=new Date;function X(){if(l.value)return;console.log("addTime");let e=new Date;a.value.playingTime=((e-se)/1e3).toFixed(2),setTimeout(X,10)}return j(()=>{document.addEventListener("keydown",e=>{B.value=e.key}),document.addEventListener("keyup",e=>{B.value=null}),z(()=>{t.value=c.value.clientWidth,r.value=c.value.clientHeight,a.value.curW=h.value.clientWidth,a.value.curH=h.value.clientHeight,a.value.curX=t.value/2+15,a.value.curY=r.value-a.value.curH-10,h.value.addEventListener("mousedown",S),h.value.addEventListener("touchstart",S),h.value.addEventListener("mousemove",T),h.value.addEventListener("touchmove",T),h.value.addEventListener("mouseup",G),h.value.addEventListener("mouseleave",G),h.value.addEventListener("touchend",G),h.value.addEventListener("touchcancel",G),b(),X()})}),(e,A)=>(m(),f("div",_e,[s("pre",ke,"objectList: "+i(p.value),1),s("pre",Ce,[C("Charater: "+i(d.curCharaterData),1),Me,C("playerData: "+i(a.value),1)]),s("div",we,[s("span",null,"Lives: "+i(a.value.lives),1),Ee,s("span",null,"Scores: "+i(a.value.scores),1),Be,s("span",null,"Time: "+i(a.value.playingTime)+"s",1)]),s("div",{ref_key:"refTrack",ref:c,class:"track"},[(m(!0),f(Y,null,q(p.value,(o,P)=>(m(),f(Y,{key:o.id},[o.show?(m(),f("div",{key:0,ref_for:!0,ref:V,"data-id":o.id,class:W(["object",{hit:o.hit,hide:!o.show}]),style:Z({top:`${o.curY}px`,left:`${o.curX}px`})},[s("span",Ge,[C(" id("+i(o.id)+")"+i(o.type),1),xe,C(" X("+i(o.curX)+")",1),He,C(" Y("+i(o.curY)+") ",1)])],14,Ue)):w("",!0)],64))),128)),s("div",{ref_key:"refPlayer",ref:h,class:W(["player",{attacked:a.value.attacked,restore:a.value.restore}]),style:Z({top:`${a.value.curY}px`,left:`${a.value.curX}px`})},[s("img",{src:d.curCharaterData.imgUrl,alt:"props.curCharaterData.imgName"},null,8,Le)],6)],512)]))}},Qe={class:"game-page"},Ie=s("h2",null,"\u904A\u6232\u7D50\u675F",-1),Re={__name:"RunwayGameResult",props:{gameProgress:{},gameProgressModifiers:{},lastGameScores:{},lastGameScoresModifiers:{}},emits:["update:gameProgress","update:lastGameScores"],setup(g){const d=_(g,"gameProgress"),u=_(g,"lastGameScores");function v(){d.value="playing"}function l(){d.value="choose"}return(c,t)=>(m(),f("div",Qe,[Ie,s("h3",null,"\u4F60\u7684\u5206\u6578\u662F "+i(u.value.scores),1),s("h3",null,"\u5B58\u6D3B "+i(u.value.playingTime)+" \u79D2",1),s("h3",null,"\u88AB "+i(u.value.deathReason)+" \u64CA\u6557",1),s("button",{type:"button",onClick:v},"\u518D\u73A9\u4E00\u6B21"),s("button",{type:"button",onClick:l},"\u91CD\u9078\u89D2\u8272")]))}},be=[{id:1,name:"kana_pan"},{id:2,name:"aimer_refrain"}];var Se={charater:be};const Te={class:"runway-game"},Xe={class:"debug-text"},Ne={class:"fix-bottom"},ze={__name:"RunwayGame",setup(g){const d=M(()=>{const c=[];return Se.charater.forEach(t=>{c.push({imgId:t.id,imgName:t.name,imgUrl:new URL({"/src/assets/images/runway-game/aimer_refrain.png":ce,"/src/assets/images/runway-game/kana_pan.png":ne}[`/src/assets/images/runway-game/${t.name}.png`],self.location)})}),c}),u=n("loading"),v=n(null),l=n(null);return(c,t)=>(m(),f("div",Te,[s("span",Xe,i(u.value),1),s("pre",Ne,"lastGameScores: "+i(l.value),1),u.value=="loading"?(m(),x(ve,{key:0,gameProgress:u.value,"onUpdate:gameProgress":t[0]||(t[0]=r=>u.value=r),charaterList:d.value},null,8,["gameProgress","charaterList"])):w("",!0),u.value=="choose"?(m(),x(Pe,{key:1,gameProgress:u.value,"onUpdate:gameProgress":t[1]||(t[1]=r=>u.value=r),charaterList:d.value,curCharaterData:v.value,"onUpdate:curCharaterData":t[2]||(t[2]=r=>v.value=r)},null,8,["gameProgress","charaterList","curCharaterData"])):w("",!0),u.value=="playing"?(m(),x(Ye,{key:2,gameProgress:u.value,"onUpdate:gameProgress":t[3]||(t[3]=r=>u.value=r),lastGameScores:l.value,"onUpdate:lastGameScores":t[4]||(t[4]=r=>l.value=r),curCharaterData:v.value},null,8,["gameProgress","lastGameScores","curCharaterData"])):w("",!0),u.value=="result"?(m(),x(Re,{key:3,lastGameScores:l.value,"onUpdate:lastGameScores":t[5]||(t[5]=r=>l.value=r),gameProgress:u.value,"onUpdate:gameProgress":t[6]||(t[6]=r=>u.value=r)},null,8,["lastGameScores","gameProgress"])):w("",!0)]))}};export{ze as default};
